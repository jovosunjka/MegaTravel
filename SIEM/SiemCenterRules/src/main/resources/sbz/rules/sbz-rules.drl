
import com.bsep.SiemCenterRules.model.LoginLog;
import com.bsep.SiemCenterRules.model.Log;
import com.bsep.SiemCenterRules.model.enums.LogLevel;
import com.bsep.SiemCenterRules.model.AntivirusLog


/*rule "Neuspesna prijava na sistem na istoj masini 2+"
    when
        exists
            LoginLog(successful == false, $ha: hostAddress)
            $c: Number(intValue >= 2) from accumulate(
                            $l: LoginLog(
                                hostAddress == $ha,
                                successful == false
                            ),
                            count($l)
                        )

    then
        System.out.println("Neuspesno logovanje " + $c);
end*/

/*rule "Neuspesna prijava na sistem na istoj masini 2+"
    when
            LoginLog(successful == false, $ha: hostAddress)
            Number(intValue >=4 ) from accumulate(
                            $l: LoginLog(
                                hostAddress == $ha,
                                successful == false
                            ),
                            count($l)
                        )

    then
        System.out.println("Neuspesno logovanje ");
end*/


/*rule "Neuspesna prijava na sistem sa istim usernmaom 2+"
    when
        //exists
            LoginLog(successful == false, $ha: hostAddress)
            $c: Number(intValue >= 2) from accumulate(
                            $l: LoginLog(
                                hostAddress == $ha,
                                successful == false
                            ),
                            count($l)
                        )

    then

        System.out.println("Neuspesno logovanje " + $c);
end*/

rule "Pojava loga ciji tip je ERROR"
    when
        Log(logLevel == LogLevel.ERROR)
    then
        System.out.println("Error");
end

rule "Pokusaj prijave na nalog koji nije bio aktivan 90+ dana"
    when
            LoginLog(getDaysOfInactivity() >= 90)

    then
        System.out.println("Nije bio aktivan 90+ dana");
end

/*rule "Pojava loga u kome antivirus registruje pretnju, a da u roku od 1h se ne generise log o uspesnom eliminisanju pretnje"
    when
            $al: AntivirusLog(logLevel == LogLevel.ERROR, $ts: timestamp)
            AntivirusLog(logLevel == LogLevel.INFO, relatedLog != null, relatedLog == $al , AntivirusLog.diffrenceInHours() <= 1 )

    then
        System.out.println("Nije se generisao log o uspesnom eliminisanju pretnje");
end*/